<!DOCTYPE html>
  <html>
    <head>
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Bowlby+One+SC&family=Frijole&family=Londrina+Solid&family=Sigmar+One&display=swap" rel="stylesheet">

      <style>
        * {
          box-sizing: border-box;
          margin: 0;
        }
        html {
          scroll-behavior: smooth;
        }
        body {
          text-align: center;
          color: #FAD19D;
          font-family: helvetica;
        }
        a {
          color: #E89F5F;
          text-decoration: none;
        }
        h1 {
          font-size: 60px;
        }
        h3 {
          font-size: 20px;
        }
        h1, h3 {
          color: #E89F5F;
          letter-spacing: 3px;
          font-weight: normal;
          /* font-family: 'Bowlby One SC', cursive; */
          font-family: 'Frijole', cursive;
          /* font-family: 'Londrina Solid', cursive; */
          /* font-family: 'Sigmar One', cursive; */
        }
        #background {
          background-image: url(imgs/bg3.png);
          background-size: cover;
          background-position: center;
        }
        #canvas {
          /*background-image: url(imgs/bg3.png);
          background-position: center;
          background-size: cover;*/
          /* background-image: url(imgs/bg7.jpg);
          background-size:30%; */
          width: 80%;
          height: 80%;
          /* width: 7680px;
          height: 4320px; */
          /* background-color: red; */
        }

        #header {
          /* background-image: url(imgs/bg9.webp); */
          /* filter: blur(8px); */
          background-size:10%;
        }

        #footer {
          text-align: justify;
          padding:20px;
          line-height: 26px;
          /* background-color: #1f305e; */
          background-image: linear-gradient(#1f305e, #020650);
          font-size: 13px;
        }

        #break {
          background-image: url(imgs/bg6.webp);
          background-size:9%;
        }

        #break2 {
          background-image: url(imgs/bg9.webp);
          background-size:7%;
        }

      </style>
    </head>

    <body>
      <div id="background">
        <div id="header">
          <br>
          <h1>Connect <span style="color: #1f305e">fouR</span></h1>
          <a href="#break"><p>how to play</p></a>
          <br>
        </div>

        <!--87ceeb-->
        <canvas id="canvas" width="600" height="400">
          Your browser does not support canvas ayy lmfao.
        </canvas>
        <br>
        <br>

      <div id="break">
        <br>
        <br>
      </div>
      </div>

      <div id="footer">
        <h3>The rules of the game</h3>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        <br>
      </div>

      <div id="break2">
        <br>
        <br>
        <br>
        <br>
        <br>
      </div>

      <script type="text/javascript">
        window.onload = function() {
          //make it nicer
          var PIXEL_RATIO = (function () {
              var ctx = document.createElement("canvas").getContext("2d"),
                  dpr = window.devicePixelRatio || 1,
                  bsr = ctx.webkitBackingStorePixelRatio ||
                        ctx.mozBackingStorePixelRatio ||
                        ctx.msBackingStorePixelRatio ||
                        ctx.oBackingStorePixelRatio ||
                        ctx.backingStorePixelRatio || 1;

              return dpr / bsr;
          })();
          createHiDPICanvas = function(w, h, ratio) {
              if (!ratio) { ratio = PIXEL_RATIO; }
              var can = document.getElementById("canvas");
              can.width = w * ratio;
              can.height = h * ratio;
              can.style.width = w + "px";
              can.style.height = h + "px";
              can.getContext("2d").setTransform(ratio, 0, 0, ratio, 0, 0);
              return can;
          }

          ////////////////////////////////////////////////////////

          canvas = createHiDPICanvas(700, 500);
          context = canvas.getContext("2d");

          var t = Date.now();
          var firstX = 50;
          var firstY = 100;
          var boardWidth=7, boardHeight=6;
          var spacingX = 95, spacingY = 65;
          var spacingP = 45;
          var pieceSize = 10;
          var putPos=3;
          var canPutDown = true;
          var isBeingPlayed = true;
          var player1 = new Image();
          player1.src = 'imgs/2.png';
          var player2 = new Image();
          player2.src = 'imgs/1.png';
          // player.onload = function() {
          //     context.drawImage(player, x, y, 60, 60);
          // };
          var board = new Array(boardHeight);
          for(var i = 0; i< board.length; i++){
            board[i] = new Array(boardWidth);
          };
          for(var i = 0; i< board.length; i++){
            for(var j = 0; j< board[i].length; j++){
              board[i][j] = new Array(2);
            };
          };
          var filledSpaces = new Array(boardHeight);
          for(var i = 0; i< filledSpaces.length; i++){
            filledSpaces[i] = new Array(boardWidth);
          };
          //draw the board
          drawBoard();
          clearBoard();
          //draw cikca
          context.beginPath();
          context.arc(firstX+15+3*spacingX, firstY-spacingP, 10, 0, 2*Math.PI);
          context.fillStyle = "#1f305e";
          context.strokeStyle = "#020650";
          context.fill();
          context.stroke();


          document.addEventListener('keydown', function(event) {
              if(event.code == "ArrowLeft") {
                if(putPos>0) {
                  putPosChange(-1);
                }
              }
              else if(event.code == "ArrowRight") {
                if(putPos<6) {
                  putPosChange(1);
                }
              }
              else if(event.code == "KeyP") {
                putDown();
              }
              else if(event.code == "KeyR") {
                context.clearRect(0, firstY-23, 700, 500);
                drawBoard();
                clearBoard();
              }
          });

          function drawBoard() {
            //board is 7 x 6
            for(var i =0; i<board.length;i++) {
              for(var j = 0; j<board[i].length; j++) {
                context.beginPath();
                context.rect(firstX + spacingX*j+10, firstY + spacingY*i, pieceSize, pieceSize);
                context.fillStyle = "black";
                context.strokeStyle = "black";
                context.fill();
                context.stroke();
                board[i][j][0] = firstX + spacingX*j;
                board[i][j][1] = firstY + spacingY*i;
              }
            }
          }

          function clearBoard() {
            for(var i = 0; i< filledSpaces.length; i++){
              for(var j = 0; j< filledSpaces[i].length; j++){
                filledSpaces[i][j] = "O";
              };
            };
          }

          function putPosChange(dir) {
            context.clearRect(0, 0, 700, firstY-23);
            putPos += dir;
            context.beginPath();
            context.arc(firstX+15 + (putPos*spacingX), firstY-spacingP, 10, 0, 2*Math.PI);
            context.lineWidth = 1;
            context.strokeStyle = "#020650";
            context.fillStyle = "#1f305e";
            context.fill();
            context.stroke();
          }

          function putDown() {
            canPutDown = false;
            var where;
            for(var k = boardHeight-1; k>=0; k--) {
              if(filledSpaces[k][putPos] == "O") {
                canPutDown = true;
                where = k;
                break;
              }
            }

            if(canPutDown) {
              filledSpaces[where][putPos] = "X";
              var piecePosX = board[where][putPos][0];
              var piecePosY = board[where][putPos][1];

              context.clearRect(piecePosX, piecePosY, 10, 10);
              context.beginPath();

              drawStroop(piecePosX+2.5, piecePosY+2.5);
              //drawCheese(piecePosX+2.5, piecePosY+2.5);
            }
          }

          function checkVictory() {

            for (i = 0; i <=5; i++) {
  						for (j = 0; j <=3; j++) {
  							//check to see if the gameboard item is set to the player we are checking, if so, lets check the next 3 for a match
  							//if (filledSpaces[j][i] == i) {
  								if ((filledSpaces[i][j] == "X") && (filledSpaces[i][j+1] == "X") && (filledSpaces[i][j+2] == "X") && (filledSpaces[i][j+3] == "X")) {
  									//endGame(i);//a match has been made, so run EndGame with the player that had the win
  									//return true; //stop checking for a win - the game is over.
                    console.log("WON - horizontal");
  								}
  							//}
  						}
  					}

            for (i = 0; i < 3; i++) {
  						for (j = 0; j <=6; j++) {
  							//if (filledSpaces[j][i] == i) {
  								if ((filledSpaces[i][j] == "X") && (filledSpaces[i+1][j] == "X") && (filledSpaces[i+2][j] == "X") && (filledSpaces[i+3][j] == "X")) {
  									//endGame(i); //a match has been made - run endGame for the player who had the match.
  									//return true; //stop checking for a win - the game is over.
                    console.log("WON - vertical");
  								}
  							//}
  						}
  					}

            for (i = 0; i <3; i++) {
  						for (j = 0; j <=3; j++) {
  							//if (gameboard[j][i] == i) {
  								if ((filledSpaces[i][j] == "X") && (filledSpaces[i+1][j+1] == "X") && (filledSpaces[i+2][j+2] == "X") && (filledSpaces[i+3][j+3] == "X")) {
  									//endGame(i);
  									//return true;
                    console.log("WON -diagnoal top bottom");
  								}
  							//}
  						}
  					}

            for (i = 0; i <3; i++) {
  						for (j = 3; j <=6; j++) {
  							//if (gameboard[j][i] == i) {
  								if ((filledSpaces[i][j] == "X") && (filledSpaces[i+1][j-1] == "X") && (filledSpaces[i+2][j-2] == "X") && (filledSpaces[i+3][j-3] == "X")) {
  									//endGame(i);
  									//return true;
                    console.log("WON -diagnoal bottom top");
  								}
  							//}
  						}
  					}
          }

          //if(isBeingPlayed == true) {
          setInterval(checkVictory, 1000);
          //}

          function drawStroop(piecePosX, piecePosY) {
            context.beginPath();
            context.arc(piecePosX+12.5, piecePosY+2.5, pieceSize+10, 0, 2*Math.PI);
            context.fillStyle = "#C36532";
            context.fill();
            context.lineWidth = 2;
            context.strokeStyle = "#E89F5F";
            context.stroke();
            //decor
            context.beginPath();
            context.moveTo(piecePosX, piecePosY);
            context.lineTo(piecePosX+15, piecePosY+15);
            context.lineWidth = 1.5;
            context.strokeStyle = "#E89F5F";
            context.stroke();
            context.beginPath();
            context.moveTo(piecePosX+10, piecePosY-10);
            context.lineTo(piecePosX+27, piecePosY+8);
            context.lineWidth = 1.5;
            context.strokeStyle = "#E89F5F";
            context.stroke();
            context.beginPath();
            context.moveTo(piecePosX+2, piecePosY-6);
            context.lineTo(piecePosX+23, piecePosY+14);
            context.lineWidth = 1.5;
            context.strokeStyle = "#E89F5F";
            context.stroke();
            //
            context.beginPath();
            context.moveTo(piecePosX, piecePosY+7);
            context.lineTo(piecePosX+17, piecePosY-12);
            context.lineWidth = 1.5;
            context.strokeStyle = "#E89F5F";
            context.stroke();
            context.beginPath();
            context.moveTo(piecePosX+5, piecePosY+15);
            context.lineTo(piecePosX+25, piecePosY-7);
            context.lineWidth = 1.5;
            context.strokeStyle = "#E89F5F";
            context.stroke();
          }

          function drawCheese(piecePosX, piecePosY) {
            context.beginPath();
            context.arc(piecePosX+12.5, piecePosY+2.5, pieceSize+10, 0, 2*Math.PI);
            context.fillStyle = "#FAD19D";
            context.fill();
            context.lineWidth = 2;
            context.strokeStyle = "#F69A20";
            context.stroke();
            //decor #F8A537
            context.beginPath();
            context.arc(piecePosX+3, piecePosY, 3, 0, 2*Math.PI);
            context.fillStyle = "#F8C077";
            context.fill();
            context.lineWidth = 0.1;
            context.stroke();
            context.beginPath();
            context.arc(piecePosX+17, piecePosY+8, 2.3, 0, 2*Math.PI);
            context.fillStyle = "#F8C077";
            context.fill();
            context.lineWidth = 0.1;
            context.stroke();
            context.beginPath();
            context.arc(piecePosX+14, piecePosY-3, 2.3, 0, 2*Math.PI);
            context.fillStyle = "#F8C077";
            context.fill();
            context.lineWidth = 0.1;
            context.stroke();
          }


        };
      </script>
    </body>


  </html>
